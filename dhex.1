.\" Process this file with
.\" groff -man -Tascii dhex.1
.\"
.
.Dd January 28, 2011
.Os
.Dt DHEX 1
.
.
.Sh NAME
.Nm dhex
.Nd hex editor with a diff mode
.
.
.Sh SYNOPSIS
.
.Nm dhex
.Op Fl h
.Op Fl v
.Op Fl g
.Op Fl k
.Op Fl f Ar config-file
.Op Fl m Ar marker-file
.Op Fl ob od oh oo Ar offset
.Op Fl sa sab Ar string (ascii)
.Op Fl sh shb Ar string (hex)
.Op Fl w Ar searchlog
.Op Fl r Ar searchlog
.Op Ar file

.Nm dhex
.Op Fl h
.Op Fl v
.Op Fl g
.Op Fl k
.Op Fl f Ar config-file
.Op Fl m Ar marker-file
.Op Fl o1b|o1d|o1h|o1o Ar offset1
.Op Fl o2b|o2d|o2h|o2o Ar offset2
.Op Ar file1 file2

dhex is a hex editor. It can be used to alter individual bytes in large files. Since it is a text-mode programm based on ncurses, it can run in numerous scenarios.
.
Its special feature is the diff mode: With it, the user has a visual tool for file comparison. This mode is invoked when dhex is called with two instead of one file as parameters.
.Sh OPTIONS
All the options are case-insensitive and can be given as either upper- or lowercase characters.
.
.Ss 
.Op Fl f Ar configfile

Usually, .dhexrc is being read from the invoker's home directory. With this parameter, any other config file can be loaded. See
.Xr dhexrc 5
for a description of its file format.
.
.Ss
.Op Fl g

Shows the license
.
.Ss
.Op Fl h 

Shows the help screen
.
.Ss
.Op Fl k

Starts the keyboard setup manually before any file is being loaded. This is very helpful when calling dhex from an exotic terminal.
.Ss
.Op Fl m Ar markerfile

It is possible in dhex to set bookmarks and store them in a markerfile for later use. With this parameter, the markerfile is being read at start time, making it unnecesarry to read them later through the gui. Their file format is described in 
.Xr dhex_markers 5 .
.Ss
.Op Fl ob od oh oo Ar offset

After loading a file, the cursor is set to 0, and the first page of bytes is being shown on the screen. With one of those parameters it is possible to start at any other location in the file. The cursorposition could be given as a binary (-ob) number, as a decimal (-od), as a hexadecimal (-oh) or an octal (-oo) one. 
.Ss
.Op Fl o1b o1d o1h o1o Ar offset1

.Op Fl o2b o2d o2h o2o Ar offset2

For the diff mode, it is possible to set two different cursorpositions at start time. Again, the cursorpositions can be given as a binary (b) number, as a decimal (d), as a hexadecimal (h) or an octal (o) one. This way, it is possible to skip over the first few bytes in a file, and just compare the rest of it.
.Ss
.Op Fl r Ar searchlog
When searching from the command line, read the offsets from this searchlog.

.Ss
.Op Fl sa sab sh shb Ar string

Instead of setting the cursor offset to an absolute value, it is possible to search for a specific string from the command line. If there is an additional 
.Op Fl ob od oh oo Ar offset
present, the search will start there. It is possible to read and write search logs with 
.Op Fl r Ar searchlog
and
.Op Fl w Ar searchlog
respectively. With 
.Op Fl sa Ar string
is being interpreted as ASCII. 
.Op Fl sh Ar string
interprets it as hex. For backwards search, 
.Op Fl sab Ar string
or
.Op Fl shb Ar string
can be applied.



.Ss
.Op Fl v

Prints out the version of dhex.
.Ss
.Op Fl w Ar searchlog
When searching from the command line, write the results into this searchlog and quit.

.Sh USER INTERFACE

.Ss General

Menus have hotkeys, they are being presented in a different color. To jump from one menu item to the next, the cursor keys or the TAB key can be used.

Input fields can be closed by pressing ESC, ENTER, or any cursor key. Only pressing ESC will not save the changes made in there.

.Ss The keyboard setup

When running dhex for the first time, without any configfile present, or with the parameter -k, the first screen which will be shown is that of the keyboard setup. In this screen, the program asks the user to press certain keys. The keys which have to be pressed are (in order) ESCAPE, F1, F2, F3, F4, F5, F6, F7, F8, F9, F10, BACKSPACE, DEL, ENTER, TAB, UP, DOWN, RIGHT, LEFT, PG UP, PG DOWN, HOME, END. It also tells the user what it intends to do with those keys later. So the user can decide on any alternative he chooses. 
If he does not want to bind a specific function to a certain key, he can simply press ESCAPE and skip to the next question.

After pressing all the keys, the user can chose whether or not to write those keys into the config file.


.Ss The main screen

The main screen is broken down into three columns: The first column contains the offset within the file for the current line. The second column contains the bytes in the file in hex format. Finally, the third coumn contains the same bytes, but this time in ascii format. If a byte is not printable, it is being substituted with a '.'.
How many bytes are are being shown in a line depends on the width of the terminal. For example, if the terminal is 80 characters wide, 16 bytes are being shown in each line.

If no other -o parameter was given at start time, the cursor is being set to offset 0. It is also being shown in the hex column. Here, it can be moved with the cursor keys. When entering a hexadecimal number, the file is being edited. Changes are being shown in a differnt color. The file can be edited in the ascii column as well, simply by pressing the TAB key (or whichever key was substituted for it in the keyboard setup). Pressing TAB again will return the cursor to the hex column. Pressing F9 (or its substitute) will undo the last of the changes.

Editing is not possible in the diff mode. Here, pressing the cursor keys will move both files simultaniously.

.Ss The goto screen

Pressing F1 (or its substitute) will open the Goto... screen. Here, it is possible to jump to a specific address directly, without the need of scrolling there with the cursor keys. The address can be entered in the 'To' field. The adress entered can be either absolute or relative (to leap over a specified amount of bytes), but it has to be provied as a hexadecimal number. An absolute address is being chosen by pressing '=', and a relative one by pressing '+' or '-', for a positive or negative leap respectively.

It is also possible to set up to ten bookmarks in this screen: Pressing '0'...'9' will select one of them. Move the cursor to "Set" to alter one of those book marks. The "Diff:" fields are showing the difference between the actual cursor position and the bookmark.

Bookmarks can be stored and loaded, for this there are the "Save Markers" and "Load Markers" items on the bottom. Upon selecting one of them, the user is being prompted for a filename. It is possible to load a marker file at start time, by providing the -m parameter. dhex_marker(5) describes the format of the marker files.


.Ss Searching

Pressing F2 (or its subsitute) will open the Search... screen. Here, a short string can be entered (either in hex, or in ascii). If no logfiles are being selected, the cursor will jump to the next occurance of this search string upon selection of "Go". It can be chosen if the search is supposed to be conducted forward of backwards.

To jump to the next occurance, F3 (or its substitute) has to be pressed. To jump to the previous one, F4 has to be pressed. The search itself wraps at the edges of the file, meaning that when it reaches the end, it will start from the beginning and vice versa.


Searchlogs are an advanced way of searching: Writing to the searchlog won't jump the cursor from one occurance to the next. Instead, it will write the offsets of all of them into the logfile. Their format is described in
.Xr dhex_searchlog 5 .

Reading from this searchlog means that the search won't cover the whole file: Only the addresses which have been provided in this file are being searched. Thus it is possible to search for specific changes in the file. Like for example the number of lives stored in the save file of a game. dhex_searchlog(5) describes the format of the searchlog.

.Ss HexCal

Pressing F5 (or its substitute) will open a small 64 bit calculator. This calculator is  capable of not only performing arithmetic operations (+, -, *, /, modulo), but also logic ones. (and, or, xor, shift). Numbers can be entered as hexadecimals, decimals or in binary format. Pressing 'x' will close this screen.

.Ss Saving and quitting

Pressing F10 (or its substitute) will close dhex. In case there have been changes made to the file, a save dialog opens up. Here, it is possible to select whether or not to write the changes back into the file.
.Sh FILES
$HOME/.dhexrc: The default location of the config file. If the $HOME-variable is not set, its location has to be provided manually.
.Sh BUGS
Report bugs to 
.An Aq dettus@dettus.net . 
Make sure to include DHEX somewhere in the subject.
.Sh AUTHOR
Written by
.An Thomas Dettbarn
.Sh SEE ALSO
.Xr dhexrc 5 ,
.Xr dhex_marker 5 ,
.Xr dhex_searchlog 5
